---
import type { SeasonIndexEntry } from '../lib/types';
import { seasonUrl } from '../lib/helpers';

interface Props {
  season: SeasonIndexEntry;
}

const { season } = Astro.props;

const statusLabel = season.infeasible
  ? 'Widerspruch'
  : season.total_solutions === 1
    ? 'Gelost'
    : `${season.total_solutions} Losungen`;

const statusColor = season.infeasible
  ? 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'
  : season.total_solutions === 1
    ? 'bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400'
    : 'bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400';
---

<a
  href={seasonUrl(season.id)}
  class="group block bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 p-5 hover:border-primary-300 dark:hover:border-primary-600 hover:shadow-lg transition-all duration-200"
>
  <div class="flex items-start justify-between mb-3">
    <div>
      <h3 class="font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
        {season.display_name}
      </h3>
      <p class="text-sm text-gray-500 dark:text-gray-500 mt-0.5">{season.year}</p>
    </div>
    {season.type === 'vip' && (
      <span class="px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400">
        VIP
      </span>
    )}
  </div>

  <div class="flex items-center gap-3 text-sm">
    <span class={`px-2 py-0.5 rounded-full text-xs font-medium ${statusColor}`}>
      {statusLabel}
    </span>
    <span class="text-gray-500 dark:text-gray-500">
      Ep. {season.latest_episode}/{season.total_episodes}
    </span>
  </div>

  <div class="mt-3 flex items-center gap-4 text-xs text-gray-400 dark:text-gray-600">
    <span>{season.num_males}m / {season.num_females}f</span>
    {season.confirmed_matches > 0 && (
      <span>{season.confirmed_matches} bestatigt</span>
    )}
  </div>
</a>
